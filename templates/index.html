<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Adaptive Exam Prep</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="bg-light">
  <div class="container py-5">
    <h1 class="mb-3">ðŸŽ¯ Adaptive Exam Prep Planner</h1>
    {% if error %}
      <div class="alert alert-danger">{{ error }}</div>
    {% endif %}

    <form method="POST" id="plannerForm">
      <div class="row g-3 mb-3">
        <div class="col-md-4">
          <label class="form-label">Daily study minutes</label>
          <input type="number" name="daily_minutes" class="form-control" value="60" min="10" required>
        </div>
        <div class="col-md-4">
          <label class="form-label">Plan length (days)</label>
          <input type="number" name="days" class="form-control" value="7" min="1" max="30" required>
        </div>
        <div class="col-md-4 d-flex align-items-end">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="time_issue" name="time_issue">
            <label class="form-check-label" for="time_issue">I have time management issues (prefer short sessions)</label>
          </div>
        </div>
      </div>

      <div id="topicsContainer"></div>

      <div class="mb-3">
        <button type="button" id="addTopicBtn" class="btn btn-outline-primary">+ Add topic</button>
        <button type="submit" class="btn btn-primary">Generate Adaptive Plan</button>
      </div>
    </form>

    <hr>
    <small class="text-muted">Tip: add 2â€“6 topics to see meaningful adaptation (you can add more).</small>
  </div>

  <!-- invisible template -->
  <template id="topicTemplate">
    <div class="card mb-3 topic-block p-3">
      <div class="d-flex justify-content-between align-items-start">
        <h5 class="mb-0">Topic</h5>
        <button type="button" class="btn btn-sm btn-danger removeTopicBtn">Remove</button>
      </div>
      <div class="row mt-2 g-2">
        <div class="col-md-6">
          <input name="name[]" class="form-control" placeholder="Topic name (e.g. Algebra - Polynomials)" required>
        </div>
        <div class="col-md-6">
          <input name="subject[]" class="form-control" placeholder="Subject (e.g. Math)">
        </div>

        <div class="col-md-2">
          <label class="form-label small">Confidence</label>
          <input type="number" name="confidence[]" class="form-control" value="50" min="0" max="100">
        </div>
        <div class="col-md-2">
          <label class="form-label small">Last score</label>
          <input type="number" name="score[]" class="form-control" value="50" min="0" max="100">
        </div>
        <div class="col-md-2">
          <label class="form-label small">Difficulty</label>
          <input type="number" name="difficulty[]" class="form-control" value="50" min="0" max="100">
        </div>
        <div class="col-md-6">
          <label class="form-label small">Do you feel strong in this topic?</label>
          <select name="strong[]" class="form-select">
            <option value="no" selected>No</option>
            <option value="yes">Yes</option>
          </select>
        </div>
      </div>
    </div>
  </template>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const container = document.getElementById('topicsContainer');
  const tpl = document.getElementById('topicTemplate').content;
  const addBtn = document.getElementById('addTopicBtn');

  function addTopic() {
    const node = document.importNode(tpl, true);
    node.querySelector('.removeTopicBtn').addEventListener('click', function (e) {
      e.target.closest('.topic-block').remove();
    });
    container.appendChild(node);
  }

  // add two topic blocks initially
  addTopic();
  addTopic();

  addBtn.addEventListener('click', addTopic);
});
</script>
</body>
</html>

